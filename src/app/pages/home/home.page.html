<ion-header>
  <ion-toolbar>
    <ion-title class="">Task Matrix</ion-title>
  </ion-toolbar>
  <ion-toolbar class="-mt-1 overflow-hidden">
    <ion-segment class="custom-header-segment overflow-hidden" [scrollable]="true" (ionChange)="segmentChanged($event)"
      [value]="selectedCategory()">
      @for (item of categories(); track item.id) {
      <ion-segment-button [value]="item.id" class="opacity-0">
        <ion-label>{{item.name}}</ion-label>
      </ion-segment-button>
      }
      <ion-segment-button [value]="null" layout="icon-end" class="opacity-0">
        <ion-label>Add Matrix</ion-label>
        <ion-icon name="add"></ion-icon>
      </ion-segment-button>
    </ion-segment>
  </ion-toolbar>
</ion-header>

<ion-content class="relative">
  <div class="scroll-container overflow-x-auto w-full h-full" #matrixContainer id="matrixContainer">
    <div [ngClass]="'h-[calc(200%-100px-50px)]'"
      class="matrix-container grid grid-cols-2 grid-rows-2 w-[calc(200%-150px)] overflow-auto">
      <ion-card class="{{'matrix_top_left_class' | appConfig}} opacity-0" #card1 (click)="scrollIntoView(card1)"
        id="card1">
        <ion-card-content class="h-full w-full">
          <ion-list class="h-full overflow-auto">
            @if (matrixLists[0].length) {
            <ion-list-header>
              <ion-label>Do First</ion-label>
            </ion-list-header>
            }
            @for (item of matrixLists[0]; track item.id) {
            <app-task-item [task]="item"></app-task-item>
            } @empty {
            <div class="flex items-center justify-center h-full w-full flex-col">
              <span class="text-3xl text-center">Do First</span>
              <span class="text-center text=2xl mt-6">These are the tasks that you need to focus on immediately.</span>
            </div>
            }
          </ion-list>
        </ion-card-content>
      </ion-card>
      <ion-card class="{{'matrix_top_right_class' | appConfig}} opacity-0" #card2 (click)="scrollIntoView(card2)">
        <ion-card-content class="h-full w-full">
          <ion-list class="h-full overflow-auto">
            @if (matrixLists[1].length) {
            <ion-list-header>
              <ion-label>Schedule</ion-label>
            </ion-list-header>
            }
            @for (item of matrixLists[1]; track item.id) {
            <app-task-item [task]="item"></app-task-item>
            } @empty {
            <div class="flex items-center justify-center h-full w-full flex-col">
              <span class="text-3xl text-center">Schedule</span>
              <span class="text-center text=2xl mt-6">These are the tasks that are important but do not have a deadline
                that is approaching soon.</span>
            </div>
            }
          </ion-list>
        </ion-card-content>
      </ion-card>
      <ion-card class="{{'matrix_bottom_left_class' | appConfig}} opacity-0" #card3 (click)="scrollIntoView(card3)">
        <ion-card-content class="h-full w-full">
          <ion-list class="h-full overflow-auto">
            @if (matrixLists[2].length) {
            <ion-list-header>
              <ion-label>Delegate</ion-label>
            </ion-list-header>
            }
            @for (item of matrixLists[2]; track item.id) {
            <app-task-item [task]="item"></app-task-item>
            } @empty {
            <div class="flex items-center justify-center h-full w-full flex-col">
              <span class="text-3xl text-center">Delegate</span>
              <span class="text-center text=2xl mt-6">These are the tasks that are not important but do have a deadline
                that is approaching soon.</span>
            </div>
            }
          </ion-list>
        </ion-card-content>
      </ion-card>
      <ion-card class="{{'matrix_bottom_right_class' | appConfig}} opacity-0" #card4 (click)="scrollIntoView(card4)">
        <ion-card-content class="h-full w-full">
          <ion-list class="h-full overflow-auto">
            @if (matrixLists[3].length) {
            <ion-list-header>
              <ion-label>Eliminate</ion-label>
            </ion-list-header>
            }
            @for (item of matrixLists[3]; track item.id) {
            <app-task-item [task]="item"></app-task-item>
            } @empty {
            <div class="flex items-center justify-center h-full w-full flex-col">
              <span class="text-3xl text-center">Eliminate</span>
              <span class="text-center text=2xl mt-6">These are the tasks that are neither important nor urgent.</span>
            </div>
            }
          </ion-list>
        </ion-card-content>
      </ion-card>
    </div>
  </div>

  <ion-modal #modal trigger="open-modal" [initialBreakpoint]="0.5" [breakpoints]="[0, 0.5]"
    (didDismiss)="onModalClosed($event)">
    <ng-template>
      <app-create-task class="h-full" [modelRef]="modal" [categoryId]="selectedCategory()!"></app-create-task>
    </ng-template>
  </ion-modal>
</ion-content>

<ion-footer>
  <ion-button class="w-full m-0" id="open-modal" expand="full">Add Task</ion-button>
</ion-footer>